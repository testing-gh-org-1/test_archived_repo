package com.example.demo;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpSession;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.Statement;

// CWE-259: Use of Hard-coded Password
// CWE-798: Use of Hard-coded Credentials
public class HardcodedCredentialsVulnerability {
    
    // CWE-798: Hard-coded database credentials
    private static final String DB_PASSWORD = "admin123";
    private static final String DB_USER = "root";
    private static final String DB_URL = "jdbc:mysql://localhost:3306/mydb";
    
    // CWE-798: Hard-coded API key
    private static final String API_KEY = "AIzaSyD-9tSrke72PouQMnMX-a7eZSW0jkFMBWY";
    
    // CWE-798: Hard-coded encryption key
    private static final String ENCRYPTION_KEY = "MySecretKey12345";
    
    // CWE-259: Hard-coded admin password
    public boolean authenticateAdmin(String username, String password) {
        // Vulnerable: hard-coded admin password
        return "admin".equals(username) && "P@ssw0rd123".equals(password);
    }
    
    // CWE-798: Database connection with hard-coded credentials
    public Connection getDatabaseConnection() {
        try {
            // Vulnerable: hard-coded credentials
            return DriverManager.getConnection(DB_URL, DB_USER, DB_PASSWORD);
        } catch (Exception e) {
            return null;
        }
    }
    
    // CWE-798: Hard-coded JWT secret
    public String generateJWT(String userId) {
        String secret = "my-super-secret-jwt-key-12345";
        // Vulnerable: hard-coded JWT secret
        return "JWT with secret: " + secret;
    }
    
    // CWE-259: Hard-coded default password
    public void createUser(String username) {
        String defaultPassword = "Welcome123!";
        // Vulnerable: using hard-coded default password
    }
    
    // CWE-798: Hard-coded OAuth credentials
    public void authenticateWithOAuth() {
        String clientId = "abc123def456";
        String clientSecret = "secret_xyz789";
        // Vulnerable: hard-coded OAuth credentials
    }
    
    // CWE-798: Hard-coded AWS credentials
    public void connectToAWS() {
        String awsAccessKey = "AKIAIOSFODNN7EXAMPLE";
        String awsSecretKey = "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY";
        // Vulnerable: hard-coded cloud credentials
    }
    
    // CWE-259: Hard-coded master password
    private static final String MASTER_PASSWORD = "MasterP@ss2024!";
    
    public boolean verifyMasterPassword(String input) {
        // Vulnerable: comparing with hard-coded master password
        return MASTER_PASSWORD.equals(input);
    }
}
